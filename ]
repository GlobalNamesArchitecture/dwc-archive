require_relative '../spec_helper'

describe DarwinCore::Core do
  subject(:dwca) { DarwinCore.new(file_path) }
  subject(:core) { DarwinCore::Core.new(dwca) }
  let(:file_path) { File.join(File.expand_path('../../files', __FILE__), 
                             file_name) }
  let(:file_name) { 'data.tar.gz' }
  

  describe '.new' do
    it 'creates new core' do
      expect(core).to be_kind_of DarwinCore::Core
    end
  end
  
  describe '#id' do

    it 'returns core id' do
      expect(core.id[:index]).to eq 0
      expect(core.id[:term]).to eq 'http://rs.tdwg.org/dwc/terms/TaxonID'
    end

    context 'no coreid' do
      let(:file_name) { 'empty_coreid.tar.gz' }

      it 'does not return coreid' do
        expect(core.id[:index]).to eq 0
        expect(core.id[:term]).to be_nil
      end
    end
  end

  it 'reads core file from archive' do

    core.read

  end

end
